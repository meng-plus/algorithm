#include <stdio.h>
#include <assert.h>
#include "algorithm_module.h"


int main(int argc, char *argv[])
{
    double x[] = {108, 108.099, 108.198, 108.297, 108.396, 108.495, 108.595, 108.694, 108.793, 108.892, 108.991, 109.091, 109.19, 109.289, 109.388, 109.487, 109.586, 109.686, 109.785, 109.884, 109.983, 110.082, 110.182, 110.281, 110.38, 110.479, 110.578, 110.678, 110.777, 110.876, 110.975, 111.074, 111.173, 111.273, 111.372, 111.471, 111.57, 111.669, 111.769, 111.868, 111.967};
    double y[] = {315.689e-6, 264.934e-6, 279.018e-6, 345.008e-6, 358.117e-6, 377.427e-6, 442.797e-6, 406.923e-6, 414.009e-6, 473.356e-6, 498.069e-6, 521.719e-6, 496.297e-6, 523.136e-6, 513.747e-6, 583.9e-6, 616.497e-6, 600.73e-6, 579.737e-6, 606.133e-6, 614.105e-6, 633.149e-6, 630.58e-6, 631.82e-6, 645.816e-6, 672.92e-6, 658.748e-6, 637.932e-6, 622.874e-6, 648.65e-6, 665.037e-6, 621.545e-6, 591.429e-6, 616.939e-6, 635.718e-6, 560.339e-6, 577.346e-6, 581.597e-6, 576.283e-6, 570.082e-6, 542.623e-6};
    int n      = sizeof(x) / sizeof(x[0]);
    double coef[4];

    polyfit(x, y, n, 3, coef);

    printf("拟合的三次多项式为: y = %.12fx^3 + %.12fx^2 + %.12fx + %.12f\n", coef[3], coef[2], coef[1], coef[0]);

    double x_max_y, max_y;
    find_max_y_x(coef, 105, 113, &x_max_y, &max_y);
    printf("在范围 [105,113] 内, 最大 y 值为 %.5f 对应 x = %.5f\n", max_y, x_max_y);

    return 0;
}
